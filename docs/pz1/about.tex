\newpage
\bignumberedpart{Постановка задачі виявлення аномалій у поведінці користувачів}
\subsection{Вступ}
  
  Проблема раннього виявлення шахрайства наразі стоїть дуже гостро, оператори зв'язку по всьому світу відчувають значні втрати через шахраїв. За даними дослідження CFCA (міжнародна організація для контролю шахрайства, забезпечення доходів і запобігання втрат) в 2013 році, втрати становлять 46.3 мільярдів доларів на рік, що більше на 15\% порівняно з аналогічним дослідженням в 2011 році. Із збільшенням втрат, 8\% компаній переклали функції з боротьби з шахрайством з фінансових відділів у відділи ІТ і безпеки (зараз 38\% від усіх компаній) \cite{cfca2013survey}.

  Ігнорувати проблему шахрайства неможливо, так само як і припинити, тому мета - виявити шкідливе втручання в канали і засоби зв'язку, неправомірне використання послуг якомога раніше і запобігти його.

  Системи моніторингу трафіку визначають аномальний трафік, використовуючи аналіз і побудову шаблону поведінки окремого користувача \cite{telenik2009detection} \cite{rosastelecommunications}. Такі системи зазвичай є частиною системи безпеки і не є самодостатніми - при виявленні інтервенції, залежно від політики безпеки, абонент відразу блокується або подається сигнал співробітнику оператора для ручної обробки.

  Проблемою такого підходу є періодичні і єдиноразові масові зміни поведінки абонентів системи. Прикладом можуть служити свята, як Новий рік, соціально-політичні події і багато іншого. При цьому такі події по- різному впливають на користувачів з різними шаблонами поведінки, наприклад корпоративних користувачів навряд чи торкнуться сімейні свята, а такі дні як "чорна п'ятниця" вплинуть на кількість вихідних дзвінків корпоративного сегмента, але не приватних користувачів \cite{rader2014cdr}.

  Дана робота присвячена створенню системи раннього виявлення шахрайства із урахуванням вказаної проблеми, для цього користувачі будуть кластеризовані у групи, всередині яких буде проводитися пошук аномалій.

\subsection{Передумови}
	Розглянемо офісну міні-АТС (PBX), яка обслуговує телефонних абонентів одного або кількох офісних приміщень або будинків. В результаті використання ресурсів неавторизованим користувачем, або авторизованим нелегально, можуть бути вагомі неотримані прибутки компанією оператором. Ці неотримані прибутки можуть бути покладені на абонентом (в даному випадку абонентом є компанія-замовник АТС, де кінцевими абонентами є співробітники компанії), АТС якого був використаний нелегально. В разі доведення абонентом (можливо в судовому порядку), що втрати були понесені внаслідок атаки, оператор може не отримати ці кошти, хоча послуга вже отримана та зроблені витрати на надання послуги.

	Розглянемо телефонну мережу оператора стаціонарного чи мобильного зв'язку. В такій мережі існує велика кількість АТС (PBX), розподілених по території та які обслуговують велику кількість абонентів. Внаслідок нелегального використання послуг оператор може понести великі операційні збитки, а також істотні збитки у судових справах.

\subsection{Основні поняття}
	Наразі існують два доступних види телефонних комунікацій. Перший це наземні аналогові лінії, які передають неперервний хвилевий сигнал, другий використовує цифрову передачу сигналу, в якому трафік кодується за допомогою швидкої передачі бінарних імпульсів. На даний момент оператори мобільного зв'язку використовують цифровий спосіб передаці голосових даних та більшість операторів наземного перейшли на цифрові системи. 

	Протокол SIP у телефонії використовується майже скрізь, цифрові системи АТС (PBX) характеризуються легкістю аналізу даних. Call Detail Record (CDR), також відомий як запис даних виклику, є записом у журналі телефонної станції або іншого телекомунікаційного обладнання, що містить атрибути, характерні для одного телефонного дзвінка або іншої послуги зв'язку, яка була оброблена системою.

	Види шахрайства та втручання в систему були досліджені у роботі \cite{barson1996detection} та компанією TransNexus \cite{transnexus2012voipfraud},

\begin{itemize}
  \item Клонування телефонів - отримання доступу до мережі шляхом емуляції ідентифікаційного коду
другого справжнього мобільного телефону. Дані, що містяться на чіпі мобільного телефону (або SIM-картці) копіюються з одного мобільного телефону на інший. Цей тип шахрайства можна виявити в пересіченні телефонних дзвінків у часі,
  \item Шахрайство при підключенні - використання фальшивих ідентифікаційних даних для підключення до мережі. Цей тип шахрайства зазвичай не може бути визначений до першого зняття грошей з рахунку. Дані підключення також можуть бути скопійовані, тоді у мережі будуть присутні кілька телефонів, підключених з одними ідентифікаційними даними,
  \item Крадіжка телефону - легитимний власник телефону втрачає можливість робити дзвінки, а витрати робить неавторизована особа,
  \item Злам АТС - зазвичай використовується для виконання міжнародних дзвінків через чужу телефонну станцію. шахраї можуть використовувати вразливості у ПЗ АТС та можуть згенераувати значну кількість трафіку,
  \item Дзвінки на нерозподілені номери - шахраї можуть штучно створювати неіснуючі напрямки дзвінків та реєструватися єдиними провайдерами, що можуть з'єднати з номерами цих напрямків. Створюючи трафік на такі неіснуючі номери, дзвінки будуть перенаправлятися на компанію-шахрая.
\end{itemize}

Основними моментами для визначення втручання у систему можна визначити \cite{barson1996detection}:

\begin{itemize}
  \item Шахрайство є динамічним за своєю природою: нечесна поведінка буде змінюватися з плином часу,
  \item Розмірність задачі є достатньо великою за рахунок кількості абонентів, що мають бути відслідковані одночасно,
  \item Швидке виявлення шахрайства необхідно: збитки від шахрайства, як правило, ростуть експоненційно \cite{bliss1993fraud},
  \item Система має бути прозорою, клієнт не повинен бачити систему виявлення шахрайства в дії. Система виявлення аномалій не повинна бути максимально розумною, щоб надавати найменшу кількість хибно-позитивних та хибно-негативних сигналыв, але і не має бути автоматичною. Телефон не має бути заблокований, якщо немає достатньої впевненості, що це є зловмисник.
\end{itemize}

\subsection{Формальна постановка задачі}


	Розглянемо потік подій $\{T_i\}, i = \overline{1..n}$, де кожна подія $T_i$ характеризується кортежем
  \begin{equation}\label{eq:tuple} (src, time) \end{equation}
  \begin{ESKDexplanation}
    \item де src -- номер абонента, що ініціював дзвінок;
    \item time -- час ініціювання дзвінка.
  \end{ESKDexplanation}

  Кожен абонент має унікальний номер $src$, за яким його можна ідентифікувати. Задача розроблюваного алгоритму та системи - визначити у реальному часі чи є потік подій для конкретного абонента аномальним, чи співпадає із очікованим шаблоном поведінки.

  \begin{equation}\label{eq:stream}\{T_i^{p}\} = \{x | x \in T_i \wedge x_1 = p\}\end{equation}
  \begin{ESKDexplanation}
    \item де p - номер телефону.
  \end{ESKDexplanation}

  Тоді потік можна записати як сукупність потоків 

  \begin{equation}\label{eq:stream_sum}\{T_i\} = \{T_i^{p_1}\} \cup \{T_i^{p_2}\} \cup ... \cup \{T_i^{p_k}\} \end{equation}
  \begin{ESKDexplanation}
    \item де k - кількість телефонних номерів.
  \end{ESKDexplanation}

  Шаблон поведінки користувача - функція, що показує інтенсивність дзвінків від часу
  \begin{equation}\label{eq:pattern}P: t \rightarrow \lambda \end{equation}

  \begin{ESKDexplanation}
    \item де $\lambda$ - це кількість дзвінків на одиницю часу.
  \end{ESKDexplanation}

  Для кожного моменту часу $t$ можна визначити частоту, де шаблонна частота 
\begin{equation}\label{eq:pattern_freq} \lambda_t^p = P^p(t) \end{equation}

  а фактична частота
 \begin{equation}\label{eq:real_freq} \lambda_{rt}^p = F(\{T_i^p\}) \end{equation}
 \begin{ESKDexplanation}
    \item де $F$ - це функція розрахунку поточної частоти дзвінків.
  \end{ESKDexplanation}

  Задача 1: Сформувати шаблони поведінки для кожного номеру за історією подій: $\{T_i^{p}\} \rightarrow P^{p}$.

  Задача 2: Визначити функцію $F({T_i^p})$ (\ref{eq:real_freq}) На базі cформованих шаблонів поведінки $P^{p}$ та потоку подій $\{T_i\}, i = \overline{1..n}$ визначити чи є подія $T_{n+1}$ аномальною.

\newpage
\subsection*{Висновки}
\addcontentsline{toc}{subsection}{Висновки}
    \TBD


