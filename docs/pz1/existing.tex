\newpage
\bignumberedpart{Огляд існуючих розв'язків}
\subsection{Види систем виявлення вторгнень}

\subsubsection{Системи виявлення аномалій (ADS)}

Система виявлення аномалій в реальному часі базується на гіпотезі, що 
експлуатація вразливостей системи включає аномальне використання системи.
Тому, порушення безпеки можуть бути виявлені як відмінне від звичайного
використання системи \cite{denning1987intrusion}.

Модель системи заснована на правилах перевірки відповідності шаблону. Коли
створюється запис аудиту, він порівнюється з профілями користувачів, додає
інформацію у відповідні профілі, потім визначає, які правила застосовувати для
оновлення профілів, перевірки аномальної поведінки і як повідомляти, що аномалії
виявлені. Щаблони профілів визначаються оператором з системи моніторингу, але
правила і профілі структури в певній мірі незалежні від системи.
% у меня не так, у меня профили тоже делает система (только отдельный модуль)

Основна ідея полягає в спостереженні за стандартними операціями у цільовій
системі: входи, команди, запуск програм, доступ до файлів і пристроїв і т.д. 
Модель не містить будь-яких особливих механізмів для визначення складних дій, 
які використовують відомі або підозрілі дефекти в безпеці цільової системи; 
дійсно, система не має ніяких знань про механізми безпеки на цільовій системі 
або їх недоліки. Хоча механізм виявлення вторгнень на основі відомих або 
підозрілих дефектів може бути достатьно ефективним, було б значно складніше 
упоратися із вторгненнями, які використовують недоліки, що не підозрюються або с 
пов'язані із персоналом, який обслуговує цільову систему.

Припущенням ADS (Anomaly Detection System) є те, що дії зловмисника
(події в атакованій системі) обов'язково відрізняються від поведінки легального
користувача, тобто є аномаліями. Тому такі системи здатні реєструвати і невідомі
атаки. Роботі ADS передує період навчання, коли складаються шаблони легальної
активності системи, процесу чи користувача. Вони стають еталоном, відносно якого
оцінюють нові дії користувачів та процесів. Можливі два загальні види
помилок \cite{axelsson1999base}:

\begin{enumerate}
\item  помилкові спрацювання - визначення легального користувача зловмисником;
\item  помилкові неспрацювання - невизначення зловмисника.
\end{enumerate}

Хоча жодна з цих ситуацій небажана, але друга все ж таки небезпечніша, і тому
одним з основних завдань побудови ADS є чітке визначення умов, за яких ситуація
сприймається як аномальна, так, щоб жодна з перелічених ситуацій не виникала
занадто часто.

\subsubsection{Системи виявлення нелегального використання (MDS)}

Атака є багатокроковим процесом, його здійснення потребує високої кваліфікації
зловмисника. Тому найпростішим способом злому або приведення системи в
недієздатний стан є застосування модулів, що реалізують необхідні етапи
атаки. Як наслідок, часто послідовність аудит-подій, що реалізують атаку,
фіксована.

Робота MDS (Misuse Detection System) базується на створенні шаблонів таких атак.
Їх рівень абстракції може бути простим, таким як наявність певних значень у
заголовку мережевого пакета або послідовності команд у файлі аудиту, або
складним, таким як проходження траєкторії системи у просторі станів через
певні небезпечні стани. Системи захисту такого типу ефективні, коли схема атак
відома, однак у випадках невідомої атаки або відхилень перебігу атаки від
шаблону виникають проблеми, тому слід підтримувати велику базу даних для
кожної атаки та її варіації і організовувати безперервне поповнення баз
шаблонів.

\subsection{Класифікація}

Практично всі описані в літературі методи для виявлення аномалій можна розділити
на такі підвиди \cite{kolodchak2012modern}:

\begin{enumerate}
\item ті, що базуються на зберіганні прикладів поведінки;
\item частотні;
\item нейромережеві;
\item ті, що будують скінченні автомати;
\item інші спеціальні.
\end{enumerate}


\subsubsection{Методи, основані на зберіганні прикладів поведінки}

Найбільш простим підходом є пряме запам'ятовування послідовностей
команд користувачів, доступних реєстрації (instance-based learning). Попри
неможливість застосування цього підходу в інших
випадках моделювання людської поведінки, у задачах виявлення вторгнень він є
доволі дієвим, що зумовлено обмеженою кількістю можливих дій суб'єктів
комп'ютерної системи, значною детермінованістю задач, що можна виконати, і
самою структурою операційної системи.

В телефонних мережах використання такого методу обмежене, тому що характер
даних, що журналюються не є послідовнісним. Найчастіше всі дані, що доступні
системі - це CDR. Хоча, якщо є доступ до повних журналів SIP то дані системи
можуть бути дуже ефективними \cite{niccolini2006sip}.

Системи, що навчаються на основі прикладів створюють гіпотези безпосередньо з
самих спостережень \cite{russell1995artificial}. Це означає, що складність
гіпотези може рости з об'ємами даних, в гіршому випадку, гіпотеза являє собою
список N навчальних елементів і обчислювальна складність класифікації одного
нового екземпляра є $O(n)$. Перевагою навчання на основі прикладів у
порівнянні з іншими методами машинного навчання є його здатність адаптувати свою
модель для нових даних. Там, де інші методи зазвичай вимагають весь набір
навчальних даних переглядати повністю, коли додається новий екземпляр, ця модель
може просто зберегти новий екземпляр.


\subsubsection{Методи на базі частотної моделі}

Розвиненням ідей instance-based систем є врахування частотного розподілу
параметрів системи. Вже в моделі Денінга пропонувалося зберігати інформацію про
суб'єктів у шаблонах активності -виражених у статистичних термінах наборах
характеристик поведінки суб' єкта відносно певного об' єкта, таких як: входження
до системи, запуски програм, доступи до файлів і пристроїв, з метою реєстрації відхилень.
Потім перевіряється, чи попадає відносна кількість певних подій у заданий експертом інтервал.
Модифікацією частотного підходу є робота \cite{theus1998intrusion}, де пропонується метод,
оснований на так званих структурних нулях. Він полягає у використанні інформації про команди,
які використовують дуже рідко або зовсім не використовують, - відповідні їм комірки в таблиці
ймовірностей дорівнюють нулю, тобто є структурними нулями. Вводиться індекс унікальності,
що обчислюється для кожної сесії та кожного користувача і. Цей індекс отримує додатний
приріст для частих команд у межах поточної сесії, який тим менший, чим частіше
ця команда використовується взагалі. Так, широке використання рідких команд
спричинить великі значення індексу унікальності. В разі виникнення команд, не
властивих користувачеві, індекс зменшується. Припустивши, що значення індексу є
стабільним для певного суб' єкта, автори намагаються розрізняти їх за значеннями
індексу. Поширеними недоліками частотних методів є неадаптивність, оскільки
часто еталонні значення частот визначаються одноразово, за тренувальною множиною
або за експертними даними, і невраховування послідовності виконання команд.

\subsubsection{Методи на базі нейромережевої моделі}

Застосування нейронних мереж зумовлене самою неформальною постановкою задачі - 
виявити аномальну поведінку. Ідея полягає в тому, щоб навчити мережу деякою
тренувальною множиною параметрів вхід-вихід, що характеризують поведінку системи.
Виходом може бути деякий коефіцієнт легітимності поведінки. Якщо вхідні дані
мають закономірності, то роблять припущення, що мережа здатна навчитися на них.
Якщо в процесі роботи запропонований нейронною мережею вихід є деяким
коефіцієнтом, попадає в небезпечну область або відрізняється від наявного в
реальній системі за умови, що це один із параметрів системи, то робиться
висновок, що в системі наявна аномалія.

Зокрема, нейронні мережі із прямим розповсюдженням з поширенням алгоритму навчання були використані у \cite{shun2008network}.

Може використовуватись модифікація ІНС, така як FC-ANN (Fuzzy Clustering - Artificial Neural Networks). Загальний порядок FC-ANN полягає в наступному: по-перше техніка кластеризації використовується для створення різних навчальних підмножин. Далі на основі різних навчальних підмножин, різні моделі ANN навчаються сформулювати різні базові моделі. Нарешті, мета-елемент, нечіткий модуль агрегації, використовується для агрегування цих результатів \cite{gaikwad2012anomaly}.

\subsubsection{Методи, що базується на моделях, які будують скінченні автомати}

В цьому методі досягається більша моделювальна здатність, ніж у разі використання тривіальних частотних та instance-based методів. Вхідні дані розглядаються як потік дискретних подій, наприклад, системних викликів або ідентифікаторів процесів. Мета - отримати автомат, який моделює вказану послідовність подій. Для багатьох послідовностей характерно, що ймовірність наступного символу, елемента або сигналу залежить від попередніх. Часто вони залежать лише від невеликої кількості попередніх. Прикладами таких робіт можуть слугувати \cite{chen2006detecting} та \cite{gerald2005finitestate}.

Проте у разі зростання порядку ланцюгів, що може суттєво збільшити точність моделі, кількість станів відповідного автомата поводить себе як O(EL), де Е - розмір алфавіту символів; L - порядок ланцюга. Це ставить великі вимоги до ресурсів і збільшує час обробки. За вхідними даними будується матриця переходів ланцюга першого порядку і ймовірність сесії визначається як добуток імовірностей переходу між станами, що відповідають елементарним подіям у файлі аудиту. Потужнішою моделлю є приховані марковські моделі (HMM). Від марковських ланцюгів вони відрізняються тим, що вихідні символи автомата не детерміновані його станами, а залежать від них стохастично \cite{davison1998predicting}.

Метод \cite{gerald2005finitestate} використовує стандартну реалізацію скінечного автомату, але цьому передує етап, який стискає вхідну мережу багатобайтових даних в серію токенів. Кожен рядок перевіряється використовуючи окремий кінцевий автомат, кожен з яких має індивідуально налаштований потоку токенів. Для кінцевих автоматів, створених таким чином потрібно тільки невелика кількість апаратних ресурсів і загальна система призначена для споживають вхідні мережу дані зі швидкістю одне слово за один такт, незалежно від введених рядків і вхідних даних, шукали.

\subsubsection{Інші методи}

Також для виявлення аномалій використовуються байєсівські мережі,
графічні моделі представлення у власній структурі залежностей між об'єктами та розподілів імовірностей. За множиною тренувальних даних оцінюються кореляції між станами і будується мережа зі з' єднаними, залежними між собою, вузлами, ймовірності переходів між станами, які заповнюються, і зв'язані з вузлами таблиці розподілів імовірностей за даними станами вузлів-предків. Через жорстку залежність побудованої структури від наданих тренувальних даних отримана модель не є адаптивною.

У роботі \cite{eskin2000anomaly} описано цікавий підхід, який, на відміну від традиційних методик виявлення аномалій після навчання за неаномальними даними, призначений для виявлення аномалій без попереднього тренування на прикладах нормальної активності. Для цього сукупність послідовних даних подано як таку, що була згенерована <<змішаною>> стохастичною моделлю. Тобто з ймовірністю $X$ елемент послідовності є аномальним і з ймовірністю $(1-X)$ - нормальним. Розподіл A аномальних елементів за відсутності якихось апріорних даних про нього вважається рівномірним. Розподіл нормальних елементів M може оцінюватися будь-яким методом з арсеналу технік машинного навчання. Отже, маємо генеруючий розподіл-суміш. Далі, вважаючи, що відповідні розподіли відомі, можна обчислити функцію правдоподібності $L(D)$ для заданої послідовності елементів. Тоді, якщо поточний елемент $x_t$ перемістити з нормального розподілу $M$ в аномальний $A$ і при цьому правдоподібність збільшиться, то елемент там і залишається, якщо ні - нічого не змінюється. Застосування цього підходу дає змогу не залежати від чистоти тренувальних даних, які можуть містити й аномальні включення (за умови їх незначної кількості).

\subsection{Модель Денінга}

Профілі активності характеризують поведінку суб'єктів, тобто слугує <<підпісом>>, 
або описом нормальної поведінки суб'єктів. Зауважена поведінка характеризується 
в рамках статистичних метрик та моделей. Метрика - випадкова змінна $x$, що 
характеризує дискретну величину - кількість відповідних подій, що пройшли за 
певний період часу. Період може бути фіксований, або між двома іншими подіями
(вхід та вихід з системи). Спостереження (вибірка) дістається із записів аудиту 
системи (журналу) та за допомогою статистичної моделі визначають чи є нова 
спостережена величина аномальною. Статистична модель не робить припущень про
характер розподілення змінної, а визначає його із проведених
спостережень \cite{denning1987intrusion}.

Розглянуто три типа метрик:

\begin{enumerate}
  \item лічильник подій --- $x$ це кількість записів, що 
        задовільняють деякі умови за певний період часу.
  \item інтервал часу --- $x$ це інтервал часу між двома 
        пов'язаними подіями.
  \item вимір ресурсу --- $x$ це об'єм або кількість ресурсів,
        що задіяні протягом виконання одного запису журналу.
\end{enumerate}

Спосіб визначення аномалій:

\begin{enumerate}
  \item Фіксовані границі змінної $x$
  \item Середнє із середньоквадратичним відхиленням: базується на
        припущенні, що все, що ми знаємо про розподіл
        $x_1, x_2, ..., x_n$ це середнє значення
        \begin{equation}
            \overline{x} = \frac{1}{n} \sum{x_i}
        \end{equation}
        та середньоквадратичне відхилення
        \begin{equation}
            \sigma_x = \sqrt{\frac{1}{n} \sum{(x_i - \overline{x})^2}}
        \end{equation}

        Нове спостереження $x_{n+1}$ є відхиленням, якщо випадає за рамки довірчого інтервалу

        \begin{equation}
            \overline{x} - d \cdot \sigma_x < x_{n+1} < \overline{x} + d \cdot \sigma_x
        \end{equation}

    \item Багатовимірна модель: схожа на попередню модель, але
          використовує кореляцію одразу по декільком змінним.
    \item Модель марковського процесу
    \item Модель на числових рядах: враховує не тільки кількість
          подій, а й проміжки часу між ними.
\end{enumerate}

Дані змінних активності користувачів які використовуються
у профілі, можна агрегувати декільками способами: % 7 страница

\begin{itemize}
  \item класс-як-єдине -- множина всіх суб'єктів та об'єктів
        розглядається як одне ціле, всі події та змінні
        агрегуються по всьому класу.
  \item індивідуальна активність -- суб'єкти або об'єкти в 
        системі розглядаються як окремі сутності. Події та змінні агрегуються по сутностям окремо.
\end{itemize}


% \subsection{Виброси ? \TBD}
%     \TBD \cite{ben2005outlier}.

\subsection{Постановка задачі виявлення аномалій у поведінці користувачів}

\subsubsection{Приклади вторгнення}

  Розглянемо офісну міні-АТС (PBX), яка обслуговує телефонних абонентів одного або кількох офісних приміщень або будинків. В результаті використання ресурсів неавторизованим користувачем, або авторизованим нелегально, можуть бути вагомі неотримані прибутки компанією оператором. Ці неотримані прибутки можуть бути покладені на абонентом (в даному випадку абонентом є компанія-замовник АТС, де кінцевими абонентами є співробітники компанії), АТС якого був використаний нелегально. В разі доведення абонентом (можливо в судовому порядку), що втрати були понесені внаслідок атаки, оператор може не отримати ці кошти, хоча послуга вже отримана та зроблені витрати на надання послуги.

  Розглянемо телефонну мережу оператора стаціонарного чи мобильного зв'язку. В такій мережі існує велика кількість АТС (PBX), розподілених по території та які обслуговують велику кількість абонентів. Внаслідок нелегального використання послуг оператор може понести великі операційні збитки, а також істотні збитки у судових справах.

\subsubsection{Основні поняття}

  Система виявлення вторгнень - програмний або апаратний засіб, призначений для виявлення фактів несанкціонованого доступу в мережу або несанкціонованого управління ними в основному через Інтернет. Відповідний англійський термін - Intrusion Detection System (IDS).

  Для запобігання шахрайству у мережах використовують мережеві екрани, що можуть блокувати або дозволяти певний трафік через себе.
  Основна різниця між мережевим екраном (файрволом) та системою виявлення вторгнення полягає у області дії. Мережевий екран діє на границі мережі, тоді як система виявлення вторгнень - всередені, вона пропускає через себе весь трафік та виявляє аномальні ділянки.

  Наразі існують два доступних види телефонних комунікацій. Перший це наземні аналогові лінії, які передають неперервний хвилевий сигнал, другий використовує цифрову передачу сигналу, в якому трафік кодується за допомогою швидкої передачі бінарних імпульсів. На даний момент оператори мобільного зв'язку використовують цифровий спосіб передаці голосових даних та більшість операторів наземного перейшли на цифрові системи.

  Протокол SIP у телефонії використовується майже скрізь, цифрові системи АТС (PBX) характеризуються легкістю аналізу даних. Call Detail Record (CDR), також відомий як запис даних виклику, є записом у журналі телефонної станції або іншого телекомунікаційного обладнання, що містить атрибути, характерні для одного телефонного дзвінка або іншої послуги зв'язку, яка була оброблена системою.

  Види шахрайства та втручання в систему були досліджені у роботі \cite{barson1996detection} та компанією TransNexus \cite{transnexus2012voipfraud},

\begin{itemize}
  \item Клонування телефонів - отримання доступу до мережі шляхом емуляції ідентифікаційного коду
другого справжнього мобільного телефону. Дані, що містяться на чіпі мобільного телефону (або SIM-картці) копіюються з одного мобільного телефону на інший. Цей тип шахрайства можна виявити в пересіченні телефонних дзвінків у часі,
  \item Шахрайство при підключенні - використання фальшивих ідентифікаційних даних для підключення до мережі. Цей тип шахрайства зазвичай не може бути визначений до першого зняття грошей з рахунку. Дані підключення також можуть бути скопійовані, тоді у мережі будуть присутні кілька телефонів, підключених з одними ідентифікаційними даними,
  \item Крадіжка телефону - легитимний власник телефону втрачає можливість робити дзвінки, а витрати робить неавторизована особа,
  \item Злам АТС - зазвичай використовується для виконання міжнародних дзвінків через чужу телефонну станцію. шахраї можуть використовувати вразливості у ПЗ АТС та можуть згенераувати значну кількість трафіку,
  \item Дзвінки на нерозподілені номери - шахраї можуть штучно створювати неіснуючі напрямки дзвінків та реєструватися єдиними провайдерами, що можуть з'єднати з номерами цих напрямків. Створюючи трафік на такі неіснуючі номери, дзвінки будуть перенаправлятися на компанію-шахрая.
\end{itemize}

Основними моментами для визначення втручання у систему можна визначити \cite{barson1996detection}:

\begin{itemize}
  \item Шахрайство є динамічним за своєю природою: нечесна поведінка буде змінюватися з плином часу,
  \item Розмірність задачі є достатньо великою за рахунок кількості абонентів, що мають бути відслідковані одночасно,
  \item Швидке виявлення шахрайства необхідно: збитки від шахрайства, як правило, ростуть експоненційно \cite{bliss1993fraud},
  \item Система має бути прозорою, клієнт не повинен бачити систему виявлення шахрайства в дії. Система виявлення аномалій не повинна бути максимально розумною, щоб надавати найменшу кількість хибно-позитивних та хибно-негативних сигналыв, але і не має бути автоматичною. Телефон не має бути заблокований, якщо немає достатньої впевненості, що це є зловмисник.
\end{itemize}

\subsubsection{Формальна постановка задачі}


  Розглянемо потік подій $\{T_i\}, i = \overline{1..n}$, де кожна подія $T_i$ характеризується кортежем
  \begin{equation}\label{eq:tuple} (src, time) \end{equation}
  \begin{ESKDexplanation}
    \item де src -- номер абонента, що ініціював дзвінок;
    \item time -- час ініціювання дзвінка.
  \end{ESKDexplanation}

  Кожен абонент має унікальний номер $src$, за яким його можна ідентифікувати. Задача розроблюваного алгоритму та системи - визначити у реальному часі чи є потік подій для конкретного абонента аномальним, чи співпадає із очікованим шаблоном поведінки.

  \begin{equation}\label{eq:stream}\{T_i^{p}\} = \{x | x \in T_i \wedge x_1 = p\}\end{equation}
  \begin{ESKDexplanation}
    \item де p - номер телефону.
  \end{ESKDexplanation}

  Тоді потік можна записати як сукупність потоків 

  \begin{equation}\label{eq:stream_sum}\{T_i\} = \{T_i^{p_1}\} \cup \{T_i^{p_2}\} \cup ... \cup \{T_i^{p_k}\} \end{equation}
  \begin{ESKDexplanation}
    \item де k - кількість телефонних номерів.
  \end{ESKDexplanation}

  Шаблон поведінки користувача - функція, що показує інтенсивність дзвінків від часу
  \begin{equation}\label{eq:pattern}P: t \rightarrow \lambda \end{equation}

  \begin{ESKDexplanation}
    \item де $\lambda$ - це кількість дзвінків на одиницю часу.
  \end{ESKDexplanation}

  Для кожного моменту часу $t$ можна визначити частоту, де шаблонна частота 
\begin{equation}\label{eq:pattern_freq} \lambda_t^p = P^p(t) \end{equation}

  а фактична частота
 \begin{equation}\label{eq:real_freq} \lambda_{rt}^p = F(\{T_i^p\}) \end{equation}
 \begin{ESKDexplanation}
    \item де $F$ - це функція розрахунку поточної частоти дзвінків.
  \end{ESKDexplanation}

  Задача 1: Сформувати шаблони поведінки для кожного номеру за історією подій: $\{T_i^{p}\} \rightarrow P^{p}$.

  Задача 2: Визначити функцію $F({T_i^p})$ (\ref{eq:real_freq}) На базі cформованих шаблонів поведінки $P^{p}$ та потоку подій $\{T_i\}, i = \overline{1..n}$ визначити чи є подія $T_{n+1}$ аномальною.

% =============================================================================

\newpage
\subsection*{Висновки до розділу 2}
\addcontentsline{toc}{subsection}{Висновки до розділу 2}

    У розділі розглянуто основні методи, що застосовуються в ADS. В реальних IDS,
    спираючись на аналіз вищезгаданих методів, можна рекомендувати реалізувати
    комбінацію різних методів і згідно з нею робити остаточний висновок про наявність
    чи відсутність вторгнень та їх характер.

    У моделі Денінга розглянута модель системи запобігання вторгненням у цільому
    систему в реальному часі, розглянуто більшість можливих варіацій компонентів
    системи та підходів до розв'язку задачі виявлення аномалій у поведінці
    користувачів. Розроблена модель призначена для виявлення вторгнень в
    комп'ютерну систему, а не телефонну. Для використання потрібно внести деякі
    модифікації. Можливе розглядання користувачів окремо, або всю цільову
    систему вцілому. Є сенс скомбінувати два способи агрегування для більш
    точної оцінки.
